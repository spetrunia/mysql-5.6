DROP TABLE IF EXISTS tbl1;
DROP TABLE IF EXISTS tbl2;
DROP DATABASE IF EXISTS cus_test;
CREATE DATABASE cus_test;
USE cus_test;
CREATE TABLE tbl1 (
col1_1 INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
col1_2 INT(6) NOT NULL,
col1_3 INT(6) NOT NULL,
col1_4 INT(6) NOT NULL);
Warnings:
Warning	1681	Integer display width is deprecated and will be removed in a future release.
Warning	1681	Integer display width is deprecated and will be removed in a future release.
Warning	1681	Integer display width is deprecated and will be removed in a future release.
Warning	1681	Integer display width is deprecated and will be removed in a future release.
INSERT INTO tbl1 (col1_2, col1_3, col1_4) VALUES (2, 3, 4);
INSERT INTO tbl1 (col1_2, col1_3, col1_4) VALUES (3, 4, 5);
INSERT INTO tbl1 (col1_2, col1_3, col1_4) VALUES (4, 5, 6);
CREATE TABLE tbl2 (col2_1 INT(6) NOT NULL, col2_2 INT(6) NOT NULL);
Warnings:
Warning	1681	Integer display width is deprecated and will be removed in a future release.
Warning	1681	Integer display width is deprecated and will be removed in a future release.
CREATE TABLE tbl3 (
col1_1 INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
col1_2 INT(6) NOT NULL,
col3_3 INT(6) NOT NULL);
Warnings:
Warning	1681	Integer display width is deprecated and will be removed in a future release.
Warning	1681	Integer display width is deprecated and will be removed in a future release.
Warning	1681	Integer display width is deprecated and will be removed in a future release.
INSERT INTO tbl3 (col1_2, col3_3) VALUES (2, 83);
INSERT INTO tbl3 (col1_2, col3_3) VALUES (3, 84);
INSERT INTO tbl3 (col1_2, col3_3) VALUES (4, 85);
set global column_stats_control = ON;
INSERT INTO tbl2 (col2_1, col2_2)
SELECT col1_3, col1_4
FROM tbl1 WHERE col1_2 <= 100 AND col1_3 IN (1, 2, 3, 4, 5, 6);
INSERT INTO tbl2 (col2_1, col2_2)
SELECT col1_3, col3_3
FROM tbl1 INNER JOIN tbl3 USING (col1_1) WHERE tbl1.col1_2 <= 100;
SELECT COUNT(DISTINCT SQL_ID) FROM performance_schema.column_statistics;
COUNT(DISTINCT SQL_ID)
2
SELECT SQL_ID, TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME, SQL_OPERATION, OPERATOR_TYPE
FROM performance_schema.column_statistics;
SQL_ID	TABLE_SCHEMA	TABLE_NAME	COLUMN_NAME	SQL_OPERATION	OPERATOR_TYPE
900f0af0fd9e11cdf4500aa74e3f2515a01608539980fe803db95a587eb85c0f	cus_test	tbl1	col1_2	FILTER	LESS_THAN_EQUAL
900f0af0fd9e11cdf4500aa74e3f2515a01608539980fe803db95a587eb85c0f	cus_test	tbl1	col1_3	FILTER	SET_MEMBERSHIP
d2f937368d60ad16417d931f25ef078d0a0808c1b854695cf7ec851609a5f0e1	cus_test	tbl1	col1_1	FILTER	EQUAL
d2f937368d60ad16417d931f25ef078d0a0808c1b854695cf7ec851609a5f0e1	cus_test	tbl1	col1_2	FILTER	LESS_THAN_EQUAL
d2f937368d60ad16417d931f25ef078d0a0808c1b854695cf7ec851609a5f0e1	cus_test	tbl3	col1_1	FILTER	EQUAL
set global column_stats_control = OFF_HARD;
DROP TABLE tbl1;
DROP TABLE tbl2;
DROP TABLE tbl3;
DROP DATABASE cus_test;
